import subprocess

config={}
#loadconfig
config['WIRELESS_ADAPTER']=''


# 
attack_params={}
attack_params['WIRELESS_ADAPTER']=''
# Get List of Network Adapters
print('Fetching Wireless Network Adapters on Device..')
all_wireless_adapters=[]
wireless_data=''
with subprocess.Popen(['cat','/proc/net/wireless'], stdout = subprocess.PIPE) as data:
    wireless_data =data.communicate()
for line in str(wireless_data[0]).split('\\n'):
    if ('|' not in line) and len(line)>1:
        wireless_adapter_details=line.strip()
        details=wireless_adapter_details.split(':')
        name=details[0]
        
        all_wireless_adapters.append(name)
all_wireless_adapters_num=len(all_wireless_adapters)
print('Number of Wireless Adapters Found:',all_wireless_adapters_num)
print('Wireless Adapter names',all_wireless_adapters)
if all_wireless_adapters_num<=0:
    print("No Wireless Network Adapters found. Please recheck the adapters and run..")
    print('exiting the process')
    exit()
print('\n\n')

# Select Network Adapter
if config['WIRELESS_ADAPTER']!='':
    if config['WIRELESS_ADAPTER'] in all_wireless_adapters:
        attack_params['WIRELESS_ADAPTER']=config['WIRELESS_ADAPTER']
        
    else:
        print('Wireless Adapter mentioned in Config file is not present in detected adapters.')
else:
        print("Wireless Network Adapters Identified:")
        for i in range(all_wireless_adapters_num):
            print(i+1,all_wireless_adapters[i])
        while True:
            choice='XY'
            try:
                choices=[x+1 for x in range(all_wireless_adapters_num)]
                print('Choose Wireless Adapter in ',choices,':')
                choice=int(input())
                if choice in choices:
                    attack_params['WIRELESS_ADAPTER']=all_wireless_adapters[i-1]
                    break
                else:
                    print('Sorry. The Wireless Adapter with id',choice,'is not found.')
            except ValueError as ve:
                print('Expect an Integer. Select from the Identified Wireless Network Adapters')
                ve
print('Wireless Adapter Selected:',attack_params['WIRELESS_ADAPTER'])
        
# Bring Adapter down

# Change Mac Address

# Bring Adapter up

# Enable Monitor mode on Network Adapter

# 

# Disable Monitor mode on Network Adapter

# Revert back Mac Address
#data = subprocess.Popen(['ifconfig'], stdout = subprocess.PIPE)
#data = subprocess.Popen(['airodump-ng','wlan0'], stdout = subprocess.PIPE)
#output = data.communicate()

